{
	"info": {
		"_postman_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
		"name": "Titus Simulator API",
		"description": "API collection for testing Titus Simulator endpoints. This collection includes all API endpoints for roster management, simulation triggers, and status monitoring.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "12345678"
	},
	"item": [
		{
			"name": "Health Check",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{base_url}}/health",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"health"
					]
				},
				"description": "Check if the Titus Simulator API is running and healthy."
			},
			"response": []
		},
		{
			"name": "Upload Roster Data",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"FunctionName\": \"POC-NGRSIntegration\",\n    \"list_item\": {\n        \"data\": {\n            \"d\": {\n                \"results\": [\n                    {\n                        \"__metadata\": {\n                            \"PersonnelId\": \"00037056\",\n                            \"personnel_first_name\": \"Cheng Fong\",\n                            \"personnel_last_name\": \"Lee\",\n                            \"PersonnelType\": \"01\",\n                            \"PersonnelTypeDescription\": \"APO\",\n                            \"SecSeqNum\": \"01\",\n                            \"PrimarySeqNum\": \"001\",\n                            \"demand_item_id\": \"DI-8000122864-000020\",\n                            \"customer_id\": \"103936\",\n                            \"customer_name\": \"BANK OF CHINA LIMITED\",\n                            \"deployment_location\": \"Bank Of China - Westgate\",\n                            \"deployment_date\": \"/Date(1735689600000)/\",\n                            \"deploymentItm\": \"065A7B378D781FD0869E4BA3E5FE1484\",\n                            \"planner_group_id\": \"B5W\",\n                            \"plant\": \"4120\",\n                            \"planned_start_time\": \"PT10H15M00S\",\n                            \"planned_end_time\": \"PT19H15M00S\",\n                            \"demand_type\": \"01\"\n                        }\n                    },\n                    {\n                        \"__metadata\": {\n                            \"PersonnelId\": \"00012345\",\n                            \"personnel_first_name\": \"John\",\n                            \"personnel_last_name\": \"Doe\",\n                            \"PersonnelType\": \"01\",\n                            \"PersonnelTypeDescription\": \"APO\",\n                            \"SecSeqNum\": \"01\",\n                            \"PrimarySeqNum\": \"002\",\n                            \"demand_item_id\": \"DI-8000122864-000021\",\n                            \"customer_id\": \"103936\",\n                            \"customer_name\": \"BANK OF CHINA LIMITED\",\n                            \"deployment_location\": \"Bank Of China - Westgate\",\n                            \"deployment_date\": \"/Date(1735776000000)/\",\n                            \"deploymentItm\": \"065A7B378D781FD0869E4BA3E5FE3485\",\n                            \"planner_group_id\": \"B5W\",\n                            \"plant\": \"4120\",\n                            \"planned_start_time\": \"PT08H00M00S\",\n                            \"planned_end_time\": \"PT17H00M00S\",\n                            \"demand_type\": \"01\"\n                        }\n                    }\n                ],\n                \"summary\": [\n                    {\n                        \"__metadata\": {\n                            \"deployment_item\": \"065A7B378D781FD0869E4BA3E5FE1484\",\n                            \"totalQty\": 1,\n                            \"changedTime\": 20251203120000\n                        }\n                    },\n                    {\n                        \"__metadata\": {\n                            \"deployment_item\": \"065A7B378D781FD0869E4BA3E5FE3485\",\n                            \"totalQty\": 1,\n                            \"changedTime\": 20251203120001\n                        }\n                    }\n                ]\n            }\n        }\n    }\n}"
				},
				"url": {
					"raw": "{{base_url}}/upload-roster",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"upload-roster"
					]
				},
				"description": "Upload roster data (NGRS format) to the simulator. This endpoint accepts the complete NGRS roster JSON with __metadata structure and returns a unique RosterFileId along with RequestId for each PersonnelId."
			},
			"response": [
				{
					"name": "Success Response",
					"originalRequest": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"FunctionName\": \"POC-NGRSIntegration\",\n    \"list_item\": {\n        \"data\": {\n            \"d\": {\n                \"results\": [\n                    {\n                        \"__metadata\": {\n                            \"PersonnelId\": \"00037056\"\n                        }\n                    },\n                    {\n                        \"__metadata\": {\n                            \"PersonnelId\": \"00012345\"\n                        }\n                    }\n                ]\n            }\n        }\n    }\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/upload-roster",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"upload-roster"
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n    \"success\": true,\n    \"roster_file_id\": \"e8d63206-3ab3-41a5-961d-1e406c1c7de9\",\n    \"results\": [\n        {\n            \"PersonnelId\": \"00037056\",\n            \"RequestId\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\"\n        },\n        {\n            \"PersonnelId\": \"00012345\",\n            \"RequestId\": \"b2c3d4e5-f6a7-8901-bcde-f12345678901\"\n        }\n    ]\n}"
				}
			],
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"// Store the roster_file_id in environment variable for use in subsequent requests",
							"var jsonData = pm.response.json();",
							"if (jsonData.roster_file_id) {",
							"    pm.environment.set(\"roster_file_id\", jsonData.roster_file_id);",
							"    console.log(\"Stored roster_file_id: \" + jsonData.roster_file_id);",
							"}"
						],
						"type": "text/javascript"
					}
				}
			]
		},
		{
			"name": "Get Roster by RosterFileId",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{base_url}}/roster?rosterFileId={{roster_file_id}}",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"roster"
					],
					"query": [
						{
							"key": "rosterFileId",
							"value": "{{roster_file_id}}",
							"description": "UUID of the uploaded roster file"
						}
					]
				},
				"description": "Retrieve roster data by RosterFileId. Returns roster details including upload timestamp, status, and assignment data."
			},
			"response": []
		},
		{
			"name": "Get Roster Upload Logs",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{base_url}}/roster-logs",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"roster-logs"
					]
				},
				"description": "Retrieve roster upload history with timestamps and counts."
			},
			"response": []
		},
		{
			"name": "Run Simulation - Immediate Mode",
			"request": {
				"method": "POST",
				"header": [],
				"url": {
					"raw": "{{base_url}}/run-from-file?mode=immediate&rosterFileId={{roster_file_id}}",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"run-from-file"
					],
					"query": [
						{
							"key": "mode",
							"value": "immediate",
							"description": "Simulation mode: 'immediate' generates all events at once"
						},
						{
							"key": "rosterFileId",
							"value": "{{roster_file_id}}",
							"description": "UUID of the uploaded roster file (required)"
						}
					]
				},
				"description": "Trigger immediate simulation using RosterFileId. Generates all clock-in/out events at once, posts to NGRS, and cleans up database."
			},
			"response": [
				{
					"name": "Immediate Mode Success",
					"originalRequest": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{base_url}}/run-from-file?mode=immediate&rosterFileId={{roster_file_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"run-from-file"
							],
							"query": [
								{
									"key": "mode",
									"value": "immediate"
								},
								{
									"key": "rosterFileId",
									"value": "{{roster_file_id}}"
								}
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n    \"status\": \"completed\",\n    \"roster_file_id\": \"e8d63206-3ab3-41a5-961d-1e406c1c7de9\",\n    \"result\": {\n        \"mode\": \"immediate\",\n        \"assignments_found\": 40,\n        \"assignments_parsed\": 40,\n        \"events_generated\": 80,\n        \"events_posted\": 80,\n        \"records_cleaned\": 80,\n        \"ngrs_available\": true\n    }\n}"
				}
			]
		},
		{
			"name": "Run Simulation - Realtime Mode",
			"request": {
				"method": "POST",
				"header": [],
				"url": {
					"raw": "{{base_url}}/run-from-file?mode=realtime&rosterFileId={{roster_file_id}}",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"run-from-file"
					],
					"query": [
						{
							"key": "mode",
							"value": "realtime",
							"description": "Simulation mode: 'realtime' generates events based on shift timing"
						},
						{
							"key": "rosterFileId",
							"value": "{{roster_file_id}}",
							"description": "UUID of the uploaded roster file (required)"
						}
					]
				},
				"description": "Trigger realtime simulation using RosterFileId. Generates events only for shifts within 15-minute window of current time. Suitable for scheduled execution."
			},
			"response": [
				{
					"name": "Realtime Mode Success",
					"originalRequest": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{base_url}}/run-from-file?mode=realtime&rosterFileId={{roster_file_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"run-from-file"
							],
							"query": [
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8087",
			"type": "string"
		},
		{
			"key": "ngrs_clocking_url",
			"value": "http://localhost:8080/api/integration/titus/clocking",
			"type": "string"
		},
		{
			"key": "ngrs_api_key",
			"value": "your-api-key-here",
			"type": "string"
		},
		{
			"key": "roster_file_id",
			"value": "e8d63206-3ab3-41a5-961d-1e406c1c7de9",
			"type": "string"
		}
	]
}						"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n    \"status\": \"completed\",\n    \"roster_file_id\": \"e8d63206-3ab3-41a5-961d-1e406c1c7de9\",\n    \"result\": {\n        \"mode\": \"realtime\",\n        \"assignments_found\": 40,\n        \"assignments_parsed\": 40,\n        \"events_generated\": 4,\n        \"events_posted\": 4\n    }\n}"
				}
			]
		},
		{
			"name": "Run Simulation by Date",
			"request": {
				"method": "POST",
				"header": [],
				"url": {
					"raw": "{{base_url}}/run-once?date=2026-01-15",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"run-once"
					],
					"query": [
						{
							"key": "date",
							"value": "2026-01-15",
							"description": "Target date in YYYY-MM-DD format"
						}
					]
				},
				"description": "Fetch roster from NGRS API for a specific date and run simulation. Requires NGRS API to be accessible."
			},
			"response": []
		},
		{
			"name": "Get Statistics",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{base_url}}/stats",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"stats"
					]
				},
				"description": "Retrieve simulation statistics including total events generated, sent events, and completion rates."
			},
			"response": []
		},
		{
			"name": "NGRS - Receive Clocking Event (Mock)",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{ngrs_api_key}}",
						"disabled": true
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"BuWerks\": \"4120\",\n    \"ClockedDateTime\": \"20260115093022\",\n    \"ClockedDeviceId\": \"SIM-10.0.0.5\",\n    \"ClockedStatus\": \"IN\",\n    \"ClockingId\": \"00c2awe0-96f9-4dba-a891-83014e23447a\",\n    \"PersonnelId\": \"00037056\",\n    \"RequestId\": \"4aaweu6e-42be-4957-bsd5-3f721e8f4020\",\n    \"SendFrom\": \"titusSimulator\"\n}"
				},
				"url": {
					"raw": "{{ngrs_clocking_url}}",
					"host": [
						"{{ngrs_clocking_url}}"
					]
				},
				"description": "Mock endpoint representing NGRS Clocking API. This is where Titus Simulator sends clock-in/out events. Use this to test the clocking event format."
			},
			"response": []
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8085",
			"type": "string"
		},
		{
			"key": "ngrs_clocking_url",
			"value": "http://localhost:8080/api/integration/titus/clocking",
			"type": "string"
		},
		{
			"key": "ngrs_api_key",
			"value": "your-api-key-here",
			"type": "string"
		}
	]
}
